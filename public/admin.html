<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Luna Admin</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    img { width: 80px; margin: 5px; border: 2px solid transparent; cursor: pointer; }
    img.selected { border-color: blue; }
  </style>
</head>
<body>
  <h1>ðŸŒ™ Luna Admin Panel</h1>
  <h2>Select Global Avatar</h2>
  <div id="avatars"></div>
  <button onclick="saveConfig()">Save</button>

  <script>
    let selected = "";

    async function loadAvatars() {
      const res = await fetch("/avatars");
      const files = await res.json();
      const container = document.getElementById("avatars");
      files.forEach(f => {
        const img = document.createElement("img");
        img.src = f;
        img.onclick = () => {
          document.querySelectorAll("img").forEach(i => i.classList.remove("selected"));
          img.classList.add("selected");
          selected = f;
        };
        container.appendChild(img);
      });
    }

    async function saveConfig() {
      if (!selected) return alert("Pick one first!");
      await fetch("/config", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ globalAvatar: selected })
      });
      alert("Saved!");
    }

    loadAvatars();
  </script>
</body>
</html>
